<!DOCTYPE html>
<html lang="en">
<head>
  <title>Make Your Own Burger | Ultimate Burger Guide</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="Style.css" />

  <script>
    (function () {
      const theme = localStorage.getItem("theme") || "dark";
      if (theme === "light") document.documentElement.className = "light-mode";
    })();
  </script>

  <style>
    .builder-wrap { border-radius:16px; overflow:hidden; border:1px solid rgba(0,0,0,0.12); background:rgba(255,255,255,0.92); }
    .builder-panel { padding:16px; height:100%; background:rgba(255,255,255,0.98); }
    .builder-panel h4 { margin:14px 0 8px; font-size:1.05rem; }
    .builder-panel label { display:block; margin:6px 0; cursor:pointer; user-select:none; }

    .stage-wrap {
      position:relative;
      height:560px; min-height:560px;
      width:100%;
      overflow:hidden;
      background: radial-gradient(ellipse at top, rgba(255,255,255,0.08), rgba(0,0,0,0.85));
    }
    #threeStage { width:100%; height:100%; }
    #threeStage canvas { display:block; width:100% !important; height:100% !important; }

    .stage-hint {
      position:absolute; left:12px; bottom:12px;
      font-size:12px; opacity:0.9;
      background: rgba(0,0,0,0.55);
      color:#fff;
      border:1px solid rgba(255,255,255,0.18);
      padding:8px 10px;
      border-radius:10px;
      pointer-events:none;
    }
    .stage-badge {
      position:absolute; right:12px; top:12px;
      font-size:12px; opacity:0.9;
      background: rgba(0,0,0,0.55);
      color:#fff;
      border:1px solid rgba(255,255,255,0.18);
      padding:8px 10px;
      border-radius:10px;
      pointer-events:none;
      max-width:70%;
      text-align:right;
      white-space: pre-line;
    }
    .stage-error {
      padding:16px;
      color:#7a0012;
      background:rgba(255,0,0,0.10);
      border:1px solid rgba(255,0,0,0.25);
      border-radius:12px;
      margin:12px;
      font-size:14px;
      line-height:1.4;
    }

    #burger-recipe-output {
      margin-top:18px;
      padding:14px;
      border-radius:14px;
      border:1px solid rgba(0,0,0,0.12);
      background:rgba(255,255,255,0.96);
    }
    #build-burger-button { margin-top:14px; font-weight:700; }
  </style>
</head>

<body>
  <header id="main-header"><h1>Ultimate Burger Guide</h1></header>

  <nav>
    <a href="index.html">Home</a>
    <a href="city_burgers.html">Best Burgers by City</a>
    <a href="recipe_cards.html">Recipe Cards</a>
    <a href="make_your_own.html">Make Your Own</a>
    <a href="burger_battles.html">Burger Battles</a>
    <a href="submit.html">Submit Your Pick</a>
    <a href="about.html">About</a>
  </nav>

  <main class="container my-3">
    <div class="text-center my-4">
      <h2>Interactive Burger Builder (3D)</h2>
      <p class="mb-0">Choose ingredients on the left. Burger updates live and auto-rotates.</p>
    </div>

    <div class="builder-wrap row g-0">
      <div class="col-lg-5">
        <div id="burger-builder" class="builder-panel">
          <h4>1. Pick a Bun (Required)</h4>
          <label><input type="radio" name="bun" value="brioche" checked> Brioche Bun</label>
          <label><input type="radio" name="bun" value="sesame"> Sesame Seed Bun</label>
          <label><input type="radio" name="bun" value="lettuce-wrap"> Lettuce Wrap</label>

          <h4>2. Pick a Patty (Required)</h4>
          <label><input type="radio" name="patty" value="beef" checked> Beef Patty</label>
          <label><input type="radio" name="patty" value="chicken"> Grilled Chicken</label>
          <label><input type="radio" name="patty" value="veggie"> Veggie Patty</label>

          <h4>3. Add Cheese (Optional)</h4>
          <label><input type="checkbox" name="cheese" value="american"> American Cheese</label>
          <label><input type="checkbox" name="cheese" value="cheddar"> Sharp Cheddar</label>
          <label><input type="checkbox" name="cheese" value="swiss"> Swiss Cheese</label>

          <h4>4. Add Toppings (Optional)</h4>
          <label><input type="checkbox" name="topping" value="lettuce"> Crisp Lettuce</label>
          <label><input type="checkbox" name="topping" value="tomato"> Fresh Tomato</label>
          <label><input type="checkbox" name="topping" value="onions"> Raw Onions</label>

          <button id="build-burger-button" type="button" class="btn btn-primary w-100">
            Build My Burger!
          </button>
        </div>
      </div>

      <div class="col-lg-7">
        <div class="stage-wrap">
          <div id="threeStage">
            <div class="stage-error" style="color:#fff;border-color:rgba(255,255,255,0.18);background:rgba(0,0,0,0.35);">
              Loading 3D…
            </div>
          </div>
          <div class="stage-hint">Auto-rotate • Drag to orbit • Scroll to zoom</div>
          <div class="stage-badge" id="stageStatus">Status: Initialising…</div>
        </div>
      </div>
    </div>

    <div id="burger-recipe-output" aria-live="polite">
      <b>Your build summary will appear here.</b><br />
      Choose ingredients, then click “Build My Burger!”.
    </div>
  </main>

  <footer><p>© 2025 Ultimate Burger Guide</p></footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Summary (always works) -->
  <script>
    window.addEventListener("DOMContentLoaded", () => {
      const buildBtn = document.getElementById("build-burger-button");
      const outputEl = document.getElementById("burger-recipe-output");

      const LABEL = {
        bun: { brioche: "Brioche Bun", sesame: "Sesame Seed Bun", "lettuce-wrap": "Lettuce Wrap" },
        patty: { beef: "Beef Patty", chicken: "Grilled Chicken", veggie: "Veggie Patty" },
        cheese: { american: "American Cheese", cheddar: "Sharp Cheddar", swiss: "Swiss Cheese" },
        topping: { lettuce: "Crisp Lettuce", tomato: "Fresh Tomato", onions: "Raw Onions" }
      };

      function getRadioValue(name) {
        const checked = document.querySelector(`input[name="${name}"]:checked`);
        return checked ? checked.value : null;
      }
      function getCheckedValues(name) {
        return [...document.querySelectorAll(`input[name="${name}"]:checked`)].map(x => x.value);
      }

      buildBtn.addEventListener("click", (e) => {
        e.preventDefault();
        const cfg = {
          bun: getRadioValue("bun"),
          patty: getRadioValue("patty"),
          cheese: getCheckedValues("cheese"),
          topping: getCheckedValues("topping")
        };

        const bunText = LABEL.bun[cfg.bun] || cfg.bun || "—";
        const pattyText = LABEL.patty[cfg.patty] || cfg.patty || "—";
        const cheeseText = cfg.cheese.length ? cfg.cheese.map(c => LABEL.cheese[c] || c).join(", ") : "None";
        const toppingText = cfg.topping.length ? cfg.topping.map(t => LABEL.topping[t] || t).join(", ") : "None";

        outputEl.innerHTML =
          `<b>Your Burger Build:</b><br>` +
          `• Bun: ${bunText}<br>` +
          `• Patty: ${pattyText}<br>` +
          `• Cheese: ${cheeseText}<br>` +
          `• Toppings: ${toppingText}`;
      });
    });
  </script>

  <!-- ✅ LOCAL ONLY: must exist in your repo -->
  <script src="vendor/three/three.min.js"></script>
  <script src="vendor/three/OrbitControls.js"></script>

  <!-- 3D burger -->
  <script>
    (function () {
      const stageEl = document.getElementById("threeStage");
      const builderEl = document.getElementById("burger-builder");
      const stageStatus = document.getElementById("stageStatus");

      function setStatus(lines) {
        stageStatus.textContent = Array.isArray(lines) ? ("Status:\n" + lines.join("\n")) : ("Status: " + lines);
      }
      function showStageError(html) {
        stageEl.innerHTML = `<div class="stage-error">${html}</div>`;
      }

      if (!window.THREE) {
        setStatus(["3D failed", "Missing vendor/three/three.min.js"]);
        showStageError("<b>Three.js did not load.</b><br>You must add <code>vendor/three/three.min.js</code> to your repo.");
        return;
      }
      if (!THREE.OrbitControls) {
        setStatus(["3D failed", "Missing vendor/three/OrbitControls.js"]);
        showStageError("<b>OrbitControls did not load.</b><br>You must add <code>vendor/three/OrbitControls.js</code> to your repo.");
        return;
      }

      setStatus(["Three.js ✅", "Starting burger…"]);
      stageEl.innerHTML = "";

      const scene = new THREE.Scene();
      scene.background = new THREE.Color(0x05070b);

      const camera = new THREE.PerspectiveCamera(42, 1, 0.1, 100);
      camera.position.set(0, 3.1, 7.2);

      const renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setPixelRatio(Math.min(window.devicePixelRatio || 1, 2));
      stageEl.appendChild(renderer.domElement);

      const controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.enablePan = false;
      controls.target.set(0, 1.55, 0);

      scene.add(new THREE.AmbientLight(0xffffff, 0.55));
      const key = new THREE.DirectionalLight(0xffffff, 1.0);
      key.position.set(6, 10, 6);
      scene.add(key);
      const fill = new THREE.DirectionalLight(0xffffff, 0.35);
      fill.position.set(-6, 3, -6);
      scene.add(fill);
      const rim = new THREE.DirectionalLight(0xffffff, 0.25);
      rim.position.set(0, 6, -10);
      scene.add(rim);

      const ground = new THREE.Mesh(
        new THREE.PlaneGeometry(40, 40),
        new THREE.MeshStandardMaterial({ color: 0x070a10, roughness: 1 })
      );
      ground.rotation.x = -Math.PI / 2;
      ground.position.y = 0;
      scene.add(ground);

      const burgerGroup = new THREE.Group();
      burgerGroup.position.set(0, 0.20, 0);
      burgerGroup.rotation.x = -0.10;
      scene.add(burgerGroup);

      const MAT = {
        bun: new THREE.MeshStandardMaterial({ color: 0xd7a56a, roughness: 0.85 }),
        bunSesame: new THREE.MeshStandardMaterial({ color: 0xcf9658, roughness: 0.85 }),
        wrap: new THREE.MeshStandardMaterial({ color: 0x32c46a, roughness: 0.9 }),

        beef: new THREE.MeshStandardMaterial({ color: 0x2a1b14, roughness: 0.95 }),
        chicken: new THREE.MeshStandardMaterial({ color: 0xd7a070, roughness: 0.85 }),
        veggie: new THREE.MeshStandardMaterial({ color: 0x3a2a22, roughness: 0.92 }),

        american: new THREE.MeshStandardMaterial({ color: 0xffd14a, roughness: 0.55 }),
        cheddar: new THREE.MeshStandardMaterial({ color: 0xff9a2e, roughness: 0.55 }),
        swiss: new THREE.MeshStandardMaterial({ color: 0xffefcf, roughness: 0.60 }),

        lettuce: new THREE.MeshStandardMaterial({ color: 0x39da73, roughness: 0.9 }),
        tomato: new THREE.MeshStandardMaterial({ color: 0xe24c4c, roughness: 0.75 }),
        tomatoCore: new THREE.MeshStandardMaterial({ color: 0xffb3b3, roughness: 0.85 }),
        onion: new THREE.MeshStandardMaterial({ color: 0xe6d2ff, roughness: 0.85 }),
        seed: new THREE.MeshStandardMaterial({ color: 0xf1e6d6, roughness: 0.8 }),
      };

      function getRadioValue(name) {
        const checked = document.querySelector(`input[name="${name}"]:checked`);
        return checked ? checked.value : null;
      }
      function getCheckedValues(name) {
        return [...document.querySelectorAll(`input[name="${name}"]:checked`)].map(x => x.value);
      }
      function getConfig() {
        return {
          bun: getRadioValue("bun"),
          patty: getRadioValue("patty"),
          cheese: getCheckedValues("cheese"),
          topping: getCheckedValues("topping")
        };
      }

      function makeBunHalf(material, isTop, radius = 1.65, height = 0.50) {
        const g = new THREE.Group();
        const sideH = height * 0.55;
        g.add(new THREE.Mesh(new THREE.CylinderGeometry(radius * 0.98, radius * 1.02, sideH, 64), material));

        const dome = new THREE.Mesh(
          new THREE.SphereGeometry(radius * 0.98, 64, 32, 0, Math.PI * 2, 0, Math.PI / 2),
          material
        );

        if (isTop) {
          dome.position.y = sideH / 2;
          dome.rotation.x = Math.PI;
          dome.position.y += radius * 0.50;
        } else {
          dome.scale.y = 0.55;
          dome.position.y = sideH / 2 + radius * 0.20;
        }
        g.add(dome);

        g.userData.h = sideH + radius * 0.55;
        return g;
      }

      function makePatty(material) {
        const m = new THREE.Mesh(new THREE.CylinderGeometry(1.45, 1.45, 0.30, 64), material);
        m.scale.y = 0.95;
        m.userData.h = 0.30;
        return m;
      }

      function makeCheese(material) {
        const g = new THREE.Group();
        const base = new THREE.Mesh(new THREE.BoxGeometry(2.9, 0.06, 2.9), material);
        base.rotation.y = Math.PI / 4;
        g.add(base);

        const dripGeo = new THREE.BoxGeometry(0.22, 0.18, 0.10);
        const drips = [
          { x: 1.05, z: 0.90, ry: 0.5 },
          { x: -1.10, z: 0.65, ry: -0.3 },
          { x: 0.75, z: -1.05, ry: 1.0 },
        ];
        for (const p of drips) {
          const d = new THREE.Mesh(dripGeo, material);
          d.position.set(p.x, -0.10, p.z);
          d.rotation.y = p.ry;
          g.add(d);
        }
        g.userData.h = 0.09;
        return g;
      }

      function makeLettuce() {
        const g = new THREE.Group();
        const leaves = 18;
        for (let i = 0; i < leaves; i++) {
          const a = (i / leaves) * Math.PI * 2;
          const r = 1.35 + (Math.random() * 0.12);
          const leaf = new THREE.Mesh(
            new THREE.TorusGeometry(0.22 + Math.random() * 0.08, 0.05, 12, 24),
            MAT.lettuce
          );
          leaf.position.set(Math.cos(a) * r, 0, Math.sin(a) * r);
          leaf.rotation.set(Math.PI / 2, a, (Math.random() - 0.5) * 0.6);
          g.add(leaf);
        }
        g.userData.h = 0.18;
        return g;
      }

      function makeTomato() {
        const g = new THREE.Group();
        g.add(new THREE.Mesh(new THREE.CylinderGeometry(1.30, 1.30, 0.12, 64), MAT.tomato));
        const core = new THREE.Mesh(new THREE.CylinderGeometry(0.70, 0.70, 0.13, 48), MAT.tomatoCore);
        core.position.y = 0.01;
        g.add(core);
        g.userData.h = 0.12;
        return g;
      }

      function makeOnions() {
        const g = new THREE.Group();
        const rings = [{ r: 1.05, t: 0.05 }, { r: 0.88, t: 0.045 }, { r: 0.70, t: 0.040 }];
        for (const rr of rings) {
          const ring = new THREE.Mesh(new THREE.TorusGeometry(rr.r, rr.t, 16, 64), MAT.onion);
          ring.rotation.x = Math.PI / 2;
          ring.position.y = (Math.random() * 0.02);
          g.add(ring);
        }
        g.userData.h = 0.10;
        return g;
      }

      function addSesameSeeds(topBunGroup, count = 90) {
        const seedGeo = new THREE.SphereGeometry(0.035, 12, 12);
        const seeds = new THREE.InstancedMesh(seedGeo, MAT.seed, count);
        const dummy = new THREE.Object3D();

        for (let i = 0; i < count; i++) {
          const a = Math.random() * Math.PI * 2;
          const r = Math.sqrt(Math.random()) * 1.25;
          dummy.position.set(Math.cos(a) * r, 0.70, Math.sin(a) * r);
          dummy.rotation.set(Math.random() * 0.6, Math.random() * Math.PI, Math.random() * 0.6);
          dummy.scale.set(1.0, 0.7, 1.3);
          dummy.updateMatrix();
          seeds.setMatrixAt(i, dummy.matrix);
        }
        seeds.instanceMatrix.needsUpdate = true;
        topBunGroup.add(seeds);
      }

      function buildMeshes(cfg) {
        const stack = [];

        const bunMat =
          (cfg.bun === "lettuce-wrap") ? MAT.wrap :
          (cfg.bun === "sesame") ? MAT.bunSesame :
          MAT.bun;

        stack.push(makeBunHalf(bunMat, false, 1.65, 0.50));

        const pattyMat =
          (cfg.patty === "chicken") ? MAT.chicken :
          (cfg.patty === "veggie") ? MAT.veggie :
          MAT.beef;
        stack.push(makePatty(pattyMat));

        for (const c of cfg.cheese) {
          const cm = (c === "cheddar") ? MAT.cheddar : (c === "swiss") ? MAT.swiss : MAT.american;
          stack.push(makeCheese(cm));
        }

        const order = ["lettuce", "tomato", "onions"];
        for (const t of order) {
          if (!cfg.topping.includes(t)) continue;
          if (t === "lettuce") stack.push(makeLettuce());
          if (t === "tomato") stack.push(makeTomato());
          if (t === "onions") stack.push(makeOnions());
        }

        const top = makeBunHalf(bunMat, true, 1.70, 0.55);
        if (cfg.bun === "sesame") addSesameSeeds(top, 90);
        stack.push(top);

        return stack;
      }

      function rebuild() {
        while (burgerGroup.children.length) burgerGroup.remove(burgerGroup.children[0]);
        const cfg = getConfig();
        const stack = buildMeshes(cfg);

        let y = 0.45;
        for (let i = 0; i < stack.length; i++) {
          const item = stack[i];
          const h = item.userData.h || 0.20;
          y += h / 2;
          item.position.set(0, y, 0);
          y += h / 2;
          if (i !== 0 && i !== stack.length - 1) item.rotation.y += (Math.random() - 0.5) * 0.08;
          burgerGroup.add(item);
        }
      }

      function onResize() {
        const rect = stageEl.getBoundingClientRect();
        const w = Math.max(1, Math.floor(rect.width));
        const h = Math.max(1, Math.floor(rect.height));
        renderer.setSize(w, h, false);
        camera.aspect = w / h;
        camera.updateProjectionMatrix();
      }
      window.addEventListener("resize", onResize);
      onResize();

      builderEl.addEventListener("change", rebuild);
      rebuild();

      setStatus(["Ready ✅", "Local vendor scripts loaded"]);
      function animate() {
        requestAnimationFrame(animate);
        burgerGroup.rotation.y += 0.010;
        controls.update();
        renderer.render(scene, camera);
      }
      animate();
    })();
  </script>
</body>
</html>


